<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>0 → losowe 1–21 → restart (Back + klik = Next)</title>
  <style>
    html,body{margin:0;width:100%;height:100%;background:#000}
    img{position:fixed;inset:0;width:100vw;height:100vh;object-fit:contain;
        object-position:center;user-select:none;cursor:pointer}
    #counter{position:fixed;top:12px;right:12px;padding:6px 10px;background:rgba(255,255,255,.2);
             color:#fff;font:bold 18px sans-serif;border-radius:4px;z-index:9;pointer-events:none}
    #back{position:fixed;top:12px;left:12px;padding:6px 10px;background:rgba(255,255,255,.2);
          color:#fff;font:bold 16px sans-serif;border-radius:4px;z-index:9;user-select:none;cursor:pointer}
    #back.disabled{opacity:.4;cursor:default}
  </style>
</head>
<body>

<div id="back" class="disabled" aria-disabled="true">Back</div>
<div id="counter">0 / 21</div>
<img id="viewer" alt="viewer" draggable="false">

<script>
/* ── konfiguracja ───────────────────────────── */
const IMG_FOLDER = 'img/';   // pliki: 0.jpg, 1.jpg, ... 21.jpg
const EXT        = '.jpg';
const MIN_IMG    = 1;
const MAX_IMG    = 21;
/* ───────────────────────────────────────────── */

const $img  = document.getElementById('viewer');
const $cnt  = document.getElementById('counter');
const $back = document.getElementById('back');

let queue = [];   // wylosowana, stała na rundę kolejność [1..21]
let idx   = -1;   // -1 = ekran startowy (0.jpg)

/* --- narzędzia --- */
function shuffle(a){
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function newRound(){
  queue = [];
  for(let n = MIN_IMG; n <= MAX_IMG; n++) queue.push(n);
  shuffle(queue);
  idx = -1;        // zaczynamy od 0.jpg
  render();
}

function render(){
  if(idx === -1){
    $img.src = IMG_FOLDER + '0' + EXT;
    $cnt.textContent = `0 / ${MAX_IMG}`;
  } else {
    const n = queue[idx];
    $img.src = IMG_FOLDER + n + EXT;
    $cnt.textContent = `${idx+1} / ${MAX_IMG}`;
  }
  const isDisabled = idx === -1;
  $back.classList.toggle('disabled', isDisabled);
  $back.setAttribute('aria-disabled', String(isDisabled));
}

/* --- nawigacja --- */
function next(){
  if(idx === -1){ idx = 0; render(); return; }
  if(idx < queue.length - 1){ idx++; render(); return; }
  // koniec kolejki → restart z nową kolejnością i powrót na 0.jpg
  newRound();
}

function prev(){
  if(idx === -1) return; // już na 0.jpg
  idx--;
  render();
}

/* --- zdarzenia --- */
// klik w obraz = dalej
$img.addEventListener('click', next);

// Back przyciskiem
$back.addEventListener('click', () => {
  if(!$back.classList.contains('disabled')) prev();
});

// (opcjonalnie) obsługa klawiatury: ← cofnij, →/Space dalej
window.addEventListener('keydown', (e) => {
  if(e.key === 'ArrowRight' || e.key === ' ') next();
  else if(e.key === 'ArrowLeft') prev();
});

// start
newRound();
</script>
</body>
</html>
